(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[32],{"7nsL":function(e,a,t){e.exports={product:"product___qGnRU",wrap:"wrap___1LdQF",empty:"empty___1WSW-",addBtn1:"addBtn1___VXaxw",addIcon:"addIcon___2ntC4",list:"list___2Qr3E"}},GZoD:function(e,a,t){e.exports={authDialog:"authDialog____kEL2",inputRow:"inputRow___Q6s0v",label:"label___3NgvU",rowContent:"rowContent___9A2ce",ownerIcon:"ownerIcon___bFJJq",closeIcon:"closeIcon___2Nh8F",productUsers:"productUsers___zxe7w",rankCol:"rankCol___Xg47p",authSearchDropdown:"authSearchDropdown___2XNCj",userListOption:"userListOption___19egh",account:"account___zlWUb",name:"name___TeNNA",authTag:"authTag___vR0YX"}},Odr2:function(e,a,t){e.exports={upgradeLog:"upgradeLog___3Gckl",rollbackWrap:"rollbackWrap___17c2-",rollback:"rollback___1WcnC",upgradeIcon:"upgradeIcon___1Nz4P",logList:"logList___14V_1",logItem:"logItem___1YreF",tip:"tip___W3Prd",time:"time___J1EzK"}},SXhs:function(e,a,t){e.exports={trackerUpgrade:"trackerUpgrade___2QYxd",lightText:"lightText___2XAi9",titleWrap:"titleWrap___3lmAw",title:"title___zqmeN",versionTitle:"versionTitle___10Vcj",updateLog:"updateLog___VV5Bh",logItem:"logItem___3Stsi"}},WvCx:function(e,a,t){"use strict";var n=t("jehZ"),r=t.n(n),o=t("Y/ft"),l=t.n(o),c=t("q1tI"),i=t.n(c),s=t("TSYQ"),p=t.n(s),d=function(e){var a=e.className,t=e.type,n=l()(e,["className","type"]),o=p()(a,"fasticon","fasticon-".concat(t));return i.a.createElement("i",r()({className:o},n))};a["a"]=d},YEKF:function(e,a,t){e.exports={productItem:"productItem___OtOGx",productInfo:"productInfo___3kQ1l",title:"title___3fOKh",text:"text___CQ2Wa",arrow:"arrow___1dlFk",codeText:"codeText___1km98",copy:"copy___3dUXa",actionBar:"actionBar___1Wl4I",btn:"btn___1nFNC",btnIcon:"btnIcon___2sjyI",decorate:"decorate___1NJMO",noRight:"noRight___275JU",appList:"appList___3PwTu",noApp:"noApp___-mIjW",appIcon:"appIcon___3B1uP",addBtnBig:"addBtnBig___V91v9",bgChange:"bgChange___2S03a",addIcon:"addIcon___2xSY-",upgradeIcon:"upgradeIcon___GpKuz",verText:"verText___BNQ_7",trackerVersion:"trackerVersion___3RE1a",verTextOffLine:"verTextOffLine___2PSK0",actionBtn:"actionBtn___DkgeF",footer:"footer___2GKNK",footerAddIcon:"footerAddIcon___3U27F"}},"cr/l":function(e,a,t){e.exports={form:"form___2E8gl"}},p6iz:function(e,a,t){e.exports={form:"form___1C8sg",groupTitle:"groupTitle___3iiR2",appKeyRow:"appKeyRow___1sf0n",keyRefresh:"keyRefresh___3Royl",codeRow:"codeRow___1e3j_",isSaasRow:"isSaasRow___2pXl3",typeRow:"typeRow___2ByTz",sourceRow:"sourceRow___1FtQ-",jumpBtn:"jumpBtn___3NrU2",infoCircle:"infoCircle___3LMmR",infoContent:"infoContent___2WfGE"}},uFPn:function(e,a,t){"use strict";t("2qtc");var n=t("kLXV");function r(e){var a=e.title,t=void 0===a?"\u786e\u8ba4":a,r=e.content,o=void 0===r?"":r,l=e.okText,c=void 0===l?"\u786e\u8ba4":l,i=e.cancelText,s=void 0===i?"\u53d6\u6d88":i,p=e.onOk,d=void 0===p?function(){}:p,u=e.onCancel,m=void 0===u?function(){}:u;n["a"].confirm({title:t,content:o,okText:c,cancelText:s,onOk:d,onCancel:m})}a["a"]=r},v3B9:function(e,a,t){"use strict";t.r(a);t("+L6B");var n=t("2/Rp"),r=t("jehZ"),o=t.n(r),l=t("Y/ft"),c=t.n(l),i=t("2Taf"),s=t.n(i),p=t("vZ4D"),d=t.n(p),u=t("l4Ni"),m=t.n(u),h=t("ujKo"),f=t.n(h),_=t("MhPg"),g=t.n(_),v=t("q1tI"),y=t.n(v),E=t("MuoO"),k=t("WvCx"),C=t("eHn4"),w=t.n(C),b=(t("miYZ"),t("tsqr")),N=(t("5Dmo"),t("3S7+")),I=(t("g9YV"),t("wCAj")),S=t("rlhR"),A=t.n(S),T=(t("17x9"),t("usdK")),L=t("TSYQ"),x=t.n(L),P=t("uFPn"),D=t("YEKF"),U=t.n(D),R=function(e){function a(){var e,t;s()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=m()(this,(e=f()(a)).call.apply(e,[this].concat(r))),t.renderAppList=function(){var e=t.props,a=e.apps,n=e.editAuth,r=e.onOpenEdit;return y.a.createElement("div",{className:U.a.appList},Array.isArray(a)&&a.length>0?t.renderAppListDataTable():n?y.a.createElement("div",{className:U.a.addBtnBig,onClick:function(){r("app")}},y.a.createElement(k["a"],{type:"add",className:U.a.addIcon}),"\u6dfb\u52a0\u5e94\u7528"):y.a.createElement("div",{className:U.a.noApp},y.a.createElement(k["a"],{type:"app",className:U.a.appIcon}),"\u6682\u65e0\u5e94\u7528"))},t.renderAppListDataTable=function(){var e=t.props,a=e.apps,n=e.editAuth,r=e.onOpenEdit,o=[{title:"\u5e94\u7528\u540d\u79f0",dataIndex:"name",render:t.renderAppName,width:308},{title:"\u5e94\u7528\u7f16\u7801",dataIndex:"code",render:t.renderAppCode,width:n?200:300},{title:t.renderTrackerVersionTitle,dataIndex:"tracker_version_number",render:t.renderTrackerVersionContent,width:n?200:300}];return n&&o.push({key:"fast-product-app-actions",title:"\u64cd\u4f5c",render:function(e,a){return y.a.createElement(v["Fragment"],null,y.a.createElement("span",{className:U.a.actionBtn,onClick:function(){return r("app",a)}},"\u4fee\u6539"),y.a.createElement("span",{className:U.a.actionBtn,onClick:function(){return T["a"].push("/manage/page_group/".concat(a.id,"/").concat(encodeURIComponent(a.name)))}},"\u9875\u9762\u5206\u7ec4"),y.a.createElement("span",{className:U.a.actionBtn,onClick:t.handleDeleteItem.bind(A()(t),"app",a.name,a.id)},"\u5220\u9664"))}}),y.a.createElement(I["a"],{rowKey:"id",pagination:!1,columns:o,dataSource:a,footer:t.renderPageFooter()})},t.renderPageFooter=function(){var e=t.props,a=e.editAuth,n=e.onOpenEdit;return a?function(){return y.a.createElement("div",{className:U.a.footer,onClick:function(){return n("app")}},y.a.createElement(k["a"],{type:"add",className:U.a.footerAddIcon}),"\u6dfb\u52a0\u5e94\u7528")}:null},t.renderAppName=function(e,a){return y.a.createElement("span",{className:U.a.verText,onClick:t.handleGoOverview.bind(A()(t),a.code)},e)},t.renderAppCode=function(e){return e.length>23?y.a.createElement(N["a"],{placement:"top",title:e},"".concat(e.substr(0,20),"...")):y.a.createElement("span",null,e)},t.renderTrackerVersionTitle=function(){var e=t.props,a=e.needUpdateTracker,n=e.onOpenEdit,r=e.editAuth;return y.a.createElement(v["Fragment"],null,"\u63a2\u9488\u7248\u672c",r&&a&&y.a.createElement(k["a"],{type:"upgrade",className:U.a.upgradeIcon,onClick:function(){return n("tracker",null)}}))},t.renderTrackerVersionContent=function(e,a){var n=t.props,r=n.onOpenEdit,o=n.editAuth,l=y.a.createElement("span",{className:U.a.verTextOffLine},"\u79bb\u7ebf\u5e94\u7528");return a.is_online&&(l=e?y.a.createElement("span",{className:U.a.verText,onClick:function(){return r("history",a)}},e):"-"),y.a.createElement("div",{className:U.a.trackerVersion},l,o&&a.need_update&&y.a.createElement(k["a"],{type:"upgrade",className:U.a.upgradeIcon,onClick:function(){return r("tracker",a)}}))},t.handleCopyProductCode=function(){t.productCodeRef&&t.productCodeRef.select(),document.execCommand("Copy"),b["a"].success("\u4ea7\u54c1\u7f16\u7801\u590d\u5236\u6210\u529f")},t.handleDeleteItem=function(e,n,r){Object(P["a"])({title:"\u786e\u8ba4\u5220\u9664".concat(a.TYPES[e].name,"\uff1a").concat(n,"\uff1f"),content:a.TYPES[e].msg,onOk:function(){return window.g_app._store.dispatch({type:a.TYPES[e].funcName,payload:"app"===e?{product_id:t.props.id,id:r}:r})},onCancel:function(){}})},t.handleGoOverview=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";window.g_app._store.dispatch({type:"common/modifyProductAppSelection",payload:{productCode:t.props.code,appCode:e}}).then(function(e){e&&T["a"].push("/overview")})},t}return g()(a,e),d()(a,[{key:"render",value:function(){var e=this,a=this.props,t=a.editAuth,n=a.name,r=a.code,o=a.id,l=a.onOpenEdit,c=x()(U.a.productInfo,w()({},U.a.noRight,!t));return y.a.createElement("div",{className:U.a.productItem},y.a.createElement("div",{className:c},y.a.createElement("div",{style:{position:"relative",zIndex:2}},y.a.createElement("p",{className:U.a.title},"\u4ea7\u54c1\u540d\u79f0\uff1a"),y.a.createElement("p",{className:U.a.text,onClick:this.handleGoOverview.bind(this,"")},n,y.a.createElement(k["a"],{className:U.a.arrow,type:"arrow-right"}))),y.a.createElement("div",{style:{marginTop:"16px",position:"relative",zIndex:1}},y.a.createElement("p",{className:U.a.title},"\u4ea7\u54c1\u7f16\u7801\uff1a"),y.a.createElement("p",{className:U.a.codeText},r,y.a.createElement("input",{readOnly:!0,ref:function(a){e.productCodeRef=a},value:r}),y.a.createElement(k["a"],{className:U.a.copy,onClick:this.handleCopyProductCode,type:"copy"}))),t&&y.a.createElement("div",{className:U.a.actionBar},y.a.createElement("div",{className:U.a.btn,onClick:function(){return l("product")}},y.a.createElement("i",{className:x()("fasticon",U.a.btnIcon,"fasticon-edit")}),y.a.createElement("span",null,"\u4fee\u6539")),y.a.createElement("div",{className:U.a.btn,onClick:function(){return l("auth")}},y.a.createElement("i",{className:x()("fasticon",U.a.btnIcon,"fasticon-user")}),y.a.createElement("span",null,"\u6388\u6743")),y.a.createElement("div",{className:U.a.btn,onClick:this.handleDeleteItem.bind(this,"product",n,o)},y.a.createElement("i",{className:x()("fasticon",U.a.btnIcon,"fasticon-delete")}),y.a.createElement("span",null,"\u5220\u9664"))),y.a.createElement("div",{className:U.a.decorate},n.charAt(0))),this.renderAppList(),y.a.createElement("div",{style:{clear:"both"}}))}}]),a}(v["PureComponent"]);R.defaultProps={editAuth:!1,apps:[]},R.TYPES={product:{name:"\u4ea7\u54c1",msg:"\u6b64\u9879\u64cd\u4f5c\u5c06\u5220\u9664\u8be5\u4ea7\u54c1\u4ee5\u53ca\u4ea7\u54c1\u4e0b\u7684\u6240\u6709\u5e94\u7528\uff0c\u8bf7\u786e\u5b9a\u5df2\u77e5\u6653",funcName:"product/fetchDeleteProduct"},app:{name:"\u5e94\u7528",msg:"\u6b64\u9879\u64cd\u4f5c\u4e0d\u53ef\u9006\uff0c\u8bf7\u786e\u5b9a\u5df2\u77e5\u6653",funcName:"product/fetchDeleteApplication"}};var O,V,F,B,K,W,Y,q,j,z,G,M,Q,X,J,Z,H=R,$=(t("2qtc"),t("kLXV")),ee=(t("5NDa"),t("5rEg")),ae=t("p0pE"),te=t.n(ae),ne=(t("y8nQ"),t("Vl3Y")),re=t("mwIZ"),oe=t.n(re),le=t("cr/l"),ce=t.n(le),ie=(O=ne["a"].create(),O((B=F=function(e){function a(){var e,t;s()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=m()(this,(e=f()(a)).call.apply(e,[this].concat(r))),t.state={confirmLoading:!1},t.handleSubmitProduct=function(e){e.preventDefault();var a=t.props,n=a.form,r=a.onCancel,o=a.product,l=n.validateFields,c=n.resetFields;l(function(e,a){if(!e){t.setState({confirmLoading:!0});var n=te()({},a);o&&(n.id=o.id),window.g_app._store.dispatch({type:o?"product/fetchUpdateProduct":"product/fetchAddProduct",payload:n}).then(function(e){t.setState({confirmLoading:!1}),e.result&&(c(),r())})}})},t.handleCancel=function(){if(!t.state.confirmLoading){var e=t.props,a=e.form,n=e.onCancel,r=a.resetFields;r(),n()}},t.validateProductCode=function(e,a,t){a&&/[^a-zA-Z_0-9-]/.test(a)?t("\u53ea\u5141\u8bb8\u82f1\u6587\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u548c\u4e2d\u5212\u7ebf!"):t()},t}return g()(a,e),d()(a,[{key:"render",value:function(){var e=this.props,a=e.show,t=e.form,n=e.product,r=this.state.confirmLoading,o=t.getFieldDecorator,l=oe()(n,"name",""),c=oe()(n,"code","");return y.a.createElement($["a"],{width:"680px",onCancel:this.handleCancel,onOk:this.handleSubmitProduct,title:n?"\u4fee\u6539\u4ea7\u54c1":"\u6dfb\u52a0\u4ea7\u54c1",visible:a,maskClosable:!1,confirmLoading:r,okText:n?"\u4fee\u6539":"\u6dfb\u52a0",cancelText:"\u53d6\u6d88"},y.a.createElement(ne["a"],{onSubmit:this.handleSubmitProduct,className:ce.a.form},y.a.createElement(ne["a"].Item,{required:!0,label:"\u540d\u79f0",labelCol:{span:3},wrapperCol:{span:21}},o("name",{initialValue:l,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ea7\u54c1\u540d\u79f0!"}]})(y.a.createElement(ee["a"],{placeholder:"\u8bf7\u8f93\u5165\u4ea7\u54c1\u540d\u79f0",autoComplete:"off",onPressEnter:this.handleSubmitProduct}))),y.a.createElement(ne["a"].Item,{required:!0,label:"\u7f16\u7801",labelCol:{span:3},wrapperCol:{span:21}},o("code",{initialValue:c,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ea7\u54c1\u7f16\u7801!"},{validator:this.validateProductCode}]})(y.a.createElement(ee["a"],{disabled:!!c,placeholder:"\u8bf7\u8f93\u5165\u4ea7\u54c1\u7f16\u7801",autoComplete:"off",onPressEnter:this.handleSubmitProduct})))))}}]),a}(v["PureComponent"]),F.defaultProps={show:!1},V=B))||V),se=ie,pe=(t("Pwec"),t("CtXQ")),de=(t("P2fV"),t("NJEC")),ue=(t("sRBo"),t("kaz8")),me=(t("7Kak"),t("9yH6")),he=t("I90G"),fe=t("p6iz"),_e=t.n(fe),ge=me["a"].Group,ve=ue["a"].Group,ye=(K=ne["a"].create(),K((q=Y=function(e){function a(){var e,t;s()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=m()(this,(e=f()(a)).call.apply(e,[this].concat(r))),t.state={confirmLoading:!1,refreshLoading:!1,application:null},t.handleSubmitApplication=function(e){e.preventDefault();var a=t.props,n=a.form,r=a.onCancel,o=a.productId,l=a.applicationId,c=n.validateFields,i=n.resetFields;c(function(e,a){if(!e){t.setState({confirmLoading:!0});var n=te()({product_id:o},a);l&&(n.id=l),window.g_app._store.dispatch({type:l?"product/fetchUpdateApplication":"product/fetchAddApplication",payload:n}).then(function(e){t.setState({confirmLoading:!1}),e.result&&(i(),r())})}})},t.handleCopySource=function(){t.trackerUrlRef&&(t.trackerUrlRef.select(),document.execCommand("Copy"),b["a"].success("\u63a2\u9488\u5730\u5740\u590d\u5236\u6210\u529f"))},t.handleCancel=function(){if(!t.state.confirmLoading){var e=t.props,a=e.form,n=e.onCancel,r=a.resetFields;r(),n()}},t.handleRefreshAppKey=function(){var e=t.state,a=e.application,n=e.refreshLoading;n||(t.setState({refreshLoading:!0}),window.g_app._store.dispatch({type:"product/fetchUpdateAppKey",payload:t.props.applicationId}).then(function(e){var n={refreshLoading:!1};e.result&&(n.application=te()({},a,{key:e.data})),t.setState(function(){return n})}))},t.validateAppType=function(e,a,t){Array.isArray(a)&&0!==a.length?t():t("\u81f3\u5c11\u9009\u62e9\u4e00\u79cd\u5e94\u7528\u5f62\u6001")},t.validateApplicationCode=function(e,a,t){a&&/[^a-zA-Z_0-9-]/.test(a)?t("\u53ea\u5141\u8bb8\u82f1\u6587\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u548c\u4e2d\u5212\u7ebf!"):t()},t.validateSourcemapPath=function(e,a,t){/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g.test(a)?t("\u4e0d\u5141\u8bb8\u4f7f\u7528\u8868\u60c5\u7b26\uff0c\u8bf7\u4f7f\u7528\u7b26\u5408\u8981\u6c42\u7684 UTF-8 \u5b57\u7b26"):/(^\s+)|(\s+$)/.test(a)?t("\u76ee\u5f55\u524d\u540e\u4e0d\u5141\u8bb8\u4f7f\u7528\u7a7a\u683c"):/^\/|\/\/+/.test(a)?t("/ \u7528\u4e8e\u5206\u5272\u8def\u5f84\uff0c\u4f46\u4e0d\u8981\u4ee5 / \u6253\u5934\uff0c\u4e0d\u8981\u51fa\u73b0\u8fde\u7eed\u7684 /"):/\.\./.test(a)?t("\u4e0d\u5141\u8bb8\u51fa\u73b0\u540d\u4e3a .. \u7684\u5b50\u76ee\u5f55"):a.length>255?t("\u603b\u957f\u5ea6\u63a7\u5236\u5728 1-255 \u4e2a\u5b57\u7b26"):t()},t._getAppData=function(){var e=t.props.applicationId;e&&(t.setState({confirmLoading:!0}),window.g_app._store.dispatch({type:"product/fetchApplicationData",payload:e}).then(function(e){var a={confirmLoading:!1};e.result&&(a.application=e.data),t.setState(function(){return a})}))},t._clearAppData=function(){t.setState({application:null})},t}return g()(a,e),d()(a,[{key:"getSnapshotBeforeUpdate",value:function(e){var a=this.props,t=a.applicationId,n=a.show;return n&&t&&t!==e.applicationId?"get_data":!(n||!e.show)&&"clear_data"}},{key:"componentDidUpdate",value:function(e,a,t){"get_data"===t?this._getAppData():t&&this._clearAppData()}},{key:"render",value:function(){var e=this.props,t=e.show,n=e.form,r=e.applicationId,o=this.state,l=o.confirmLoading,c=o.refreshLoading,i=o.application,s=n.getFieldDecorator,p=x()(_e.a.form,w()({},_e.a.edit,r)),d=x()(_e.a.typeRow,w()({},_e.a.edit,r));return y.a.createElement($["a"],{width:"680px",onCancel:this.handleCancel,onOk:this.handleSubmitApplication,title:r?"\u4fee\u6539\u5e94\u7528":"\u6dfb\u52a0\u5e94\u7528",visible:t,maskClosable:!1,confirmLoading:l,okText:r?"\u4fee\u6539":"\u6dfb\u52a0",cancelText:"\u53d6\u6d88"},y.a.createElement(ne["a"],{onSubmit:this.handleSubmitApplication,className:p},y.a.createElement("div",{className:_e.a.groupTitle},"\u57fa\u7840\u5c5e\u6027"),r&&y.a.createElement(ne["a"].Item,{className:_e.a.appKeyRow,label:"APP Key",labelCol:{span:5},wrapperCol:{span:19}},oe()(i,"key","-")||"-",y.a.createElement(de["a"],{title:y.a.createElement("div",null,y.a.createElement("p",{style:{marginBottom:"4px"}},"\u5237\u65b0\u4e4b\u540e\uff0c\u76f8\u5173\u5de5\u5177\u4f7f\u7528\u7684APP Key\u9700\u8981\u505a\u76f8\u5e94\u8c03\u6574"),y.a.createElement("p",{style:{marginBottom:"4px"}},"\u5982\uff1a sourcemap-upload-webpack-plugin"),y.a.createElement("p",{style:{marginBottom:"0"}},"\u60a8\u786e\u5b9a\u5237\u65b0\u5417\uff1f")),onConfirm:this.handleRefreshAppKey,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},y.a.createElement("span",{className:x()(_e.a.keyRefresh)},c?y.a.createElement("div",{className:"spinner-icon primary-color"}):"\u5237\u65b0"))),y.a.createElement(ne["a"].Item,{required:!0,label:"\u540d\u79f0",labelCol:{span:5},wrapperCol:{span:19}},s("name",{initialValue:oe()(i,"name",""),rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528\u540d\u79f0!"}]})(y.a.createElement(ee["a"],{placeholder:"\u8bf7\u8f93\u5165\u5e94\u7528\u540d\u79f0",autoComplete:"off"}))),y.a.createElement(ne["a"].Item,{className:_e.a.codeRow,required:!0,label:"\u7f16\u7801",labelCol:{span:5},wrapperCol:{span:19}},s("code",{initialValue:oe()(i,"code",""),rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528\u7f16\u7801!"},{validator:this.validateApplicationCode}]})(y.a.createElement(ee["a"],{disabled:!!r,placeholder:"\u8bf7\u8f93\u5165\u5e94\u7528\u7f16\u7801",autoComplete:"off"}))),y.a.createElement(ne["a"].Item,{className:_e.a.isSaasRow,required:!1,label:"SaaS\u5e94\u7528",labelCol:{span:5},wrapperCol:{span:19}},s("is_saas",{initialValue:oe()(i,"is_saas",1)})(y.a.createElement(ge,{options:[{label:"\u5426",value:0},{label:"\u662f",value:1}]}))),y.a.createElement(ne["a"].Item,{className:_e.a.isSaasRow,required:!1,label:"\u5728\u7ebf\u5e94\u7528",labelCol:{span:5},wrapperCol:{span:19}},s("is_online",{initialValue:oe()(i,"is_online",1)})(y.a.createElement(ge,{disabled:!!r,options:[{label:"\u5426",value:0},{label:"\u662f",value:1}]}))),y.a.createElement(ne["a"].Item,{className:d,required:!0,label:"\u5e94\u7528\u5f62\u6001",labelCol:{span:5},wrapperCol:{span:19}},s("type",{initialValue:oe()(i,"type",[he["a"].pc.key]),rules:[{validator:this.validateAppType}]})(y.a.createElement(ve,{options:a.APP_TYPE_OPTIONS}))),this.renderErrorStack(),this.renderTrackerUrl()))}},{key:"renderErrorStack",value:function(){var e=this.state.application,a=this.props.form.getFieldDecorator;return y.a.createElement(v["Fragment"],null,y.a.createElement("div",{className:_e.a.groupTitle},"\u9519\u8bef\u6808\u914d\u7f6e"),y.a.createElement(ne["a"].Item,{className:_e.a.sourceRow,label:"sourcemap\u8def\u5f84",labelCol:{span:5},wrapperCol:{span:19}},a("sourcemap_path",{initialValue:oe()(e,"sourcemap_path",""),rules:[{validator:this.validateSourcemapPath}]})(y.a.createElement(ee["a"],{placeholder:"\u8bf7\u8f93\u5165sourcemap\u5b58\u50a8\u8def\u5f84\uff0c\u5982:{product_code}/{app_code}",autoComplete:"off"})),y.a.createElement(N["a"],{arrowPointAtCenter:!0,overlayClassName:_e.a.infoContent,placement:"topRight",title:y.a.createElement("div",null,"1. \u4e0d\u5141\u8bb8\u4f7f\u7528\u8868\u60c5\u7b26\uff0c\u8bf7\u4f7f\u7528\u7b26\u5408\u8981\u6c42\u7684 UTF-8 \u5b57\u7b26 ",y.a.createElement("br",null),"2. \u76ee\u5f55\u524d\u540e\u4e0d\u5141\u8bb8\u4f7f\u7528\u7a7a\u683c",y.a.createElement("br",null),"3. / \u7528\u4e8e\u5206\u5272\u8def\u5f84\uff0c\u4f46\u4e0d\u8981\u4ee5 / \u6253\u5934\uff0c\u4e0d\u8981\u51fa\u73b0\u8fde\u7eed\u7684 /",y.a.createElement("br",null),"4. \u4e0d\u5141\u8bb8\u51fa\u73b0\u540d\u4e3a .. \u7684\u5b50\u76ee\u5f55",y.a.createElement("br",null),"5. \u603b\u957f\u5ea6\u63a7\u5236\u5728 1-255 \u4e2a\u5b57\u7b26",y.a.createElement("br",null))},y.a.createElement(pe["a"],{type:"info-circle",theme:"filled",className:_e.a.infoCircle}))),y.a.createElement(ne["a"].Item,{className:_e.a.sourceRow,label:"\u865a\u62df\u76ee\u5f55\u6b63\u5219",labelCol:{span:5},wrapperCol:{span:19}},a("site_root_alias_regx",{initialValue:oe()(e,"site_root_alias_regx","")})(y.a.createElement(ee["a"],{placeholder:"\u8bf7\u8f93\u5165\u6b63\u5219\u8868\u8fbe\u5f0f",autoComplete:"off"}))))}},{key:"renderTrackerUrl",value:function(){var e=this,a=oe()(this.state.application,"tracker_resource_path","");return a?y.a.createElement(v["Fragment"],null,y.a.createElement("div",{className:_e.a.groupTitle},"\u63a2\u9488"),y.a.createElement(ne["a"].Item,{className:_e.a.sourceRow,label:"\u63a2\u9488\u5730\u5740",labelCol:{span:5},wrapperCol:{span:19}},y.a.createElement("div",null,y.a.createElement("textarea",{readOnly:!0,value:a,ref:function(a){e.trackerUrlRef=a}}),y.a.createElement("p",{className:"clearfix"},y.a.createElement("span",{className:_e.a.jumpBtn,onClick:this.handleCopySource},"\u590d\u5236"),y.a.createElement("a",{className:_e.a.jumpBtn,href:a,target:"_blank",rel:"noopener noreferrer"},"\u6253\u5f00"))))):null}}]),a}(v["PureComponent"]),Y.defaultProps={show:!1},Y.APP_TYPE_OPTIONS=[{label:he["a"].pc.name,value:he["a"].pc.key},{label:he["a"].mobile.name,value:he["a"].mobile.key},{label:he["a"].app.name,value:he["a"].app.key},{label:he["a"].wxmp.name,value:he["a"].wxmp.key}],W=q))||W),Ee=ye,ke=(t("14J3"),t("BMrR")),Ce=(t("jCWc"),t("kPKH")),we=(t("O3gP"),t("lrIw")),be=t("Y+p1"),Ne=t.n(be),Ie=t("UfWW"),Se=t.n(Ie),Ae=t("GZoD"),Te=t.n(Ae),Le=we["a"].Option,xe=(j=Object(E["connect"])(function(e){var a=e.product,t=e.loading;return{authUserList:a.authUserList,listLoading:oe()(t,["effects","product/fetchProductAuthUserList"],!1)}}),j((M=G=function(e){function a(){var e,t;s()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=m()(this,(e=f()(a)).call.apply(e,[this].concat(r))),t.searchTimer=0,t.state={userList:[],productUsers:[],userSearchValue:""},t.handleInputSearch=function(e){t.setState({userSearchValue:e}),clearTimeout(t.searchTimer),t.searchTimer=setTimeout(function(){t._getUserList(e)},500)},t.handleSelectUser=function(e,a){var n=t.props,r=n.dispatch,o=n.productId,l=oe()(a,"props.name",""),c=oe()(a,"props.hasAuth",!1);c||r({type:"product/fetchAddProductAuthUser",payload:{product_id:o,user_account:e,name:l}})},t.handleModifyOwner=function(e){var a=t.props,n=a.dispatch,r=a.productId;n({type:"product/fetchModifyProductAuth",payload:{is_add:!e.is_owner,product_id:r,user_id:e.id}})},t.handleDeleteAuthUser=function(e){var a=t.props,n=a.dispatch,r=a.productId;n({type:"product/fetchDeleteProductAuthUser",payload:{product_id:r,user_id:e.id}})},t.handleCloseModal=function(){t.setState({userList:[],userSearchValue:""}),t.props.onCancel()},t._getAuthUsers=function(){var e=t.props,a=e.productId,n=e.dispatch;n({type:"product/fetchProductAuthUserList",payload:a})},t._getUserList=function(e){t.props.dispatch({type:"user/fetchUserList",payload:e}).then(function(e){t.setState({userList:Array.isArray(e.data)?e.data:[]})})},t}return g()(a,e),d()(a,[{key:"getSnapshotBeforeUpdate",value:function(e){var a=this.props,t=a.productId,n=a.show;return!(!n||!t||t===e.productId)}},{key:"componentDidUpdate",value:function(e,a,t){t&&this._getAuthUsers()}},{key:"render",value:function(){var e=this,a=this.props,t=a.show,n=a.listLoading,r=this.state,o=r.userList,l=r.productUsers,c=r.userSearchValue,i=[{align:"center",key:"rank",title:"",render:function(e,a,t){return y.a.createElement("span",{className:Te.a.rankCol},t+1<10?"0".concat(t+1):t+1)},width:56},{title:"\u59d3\u540d",dataIndex:"name",width:185},{title:"\u57df\u8d26\u53f7",dataIndex:"account",width:175},{key:"action",title:"",render:function(a,t){return y.a.createElement(v["Fragment"],null,y.a.createElement(k["a"],{type:t.is_owner?"user-fill":"user",className:Te.a.ownerIcon,title:t.is_owner?"\u53d6\u6d88\u7ba1\u7406\u5458":"\u8bbe\u4e3a\u7ba1\u7406\u5458",onClick:e.handleModifyOwner.bind(e,t)}),y.a.createElement(pe["a"],{type:"close",className:Te.a.closeIcon,onClick:e.handleDeleteAuthUser.bind(e,t)}))}}],s=o.map(function(e){var a=e.UserCode,t=e.UserGuid,n=e.UserName,r=Se()(l,function(e){return e.account===a})>-1;return y.a.createElement(Le,{key:t,value:a,name:n,hasAuth:r,className:Te.a.userListOption},y.a.createElement("span",{className:Te.a.name,dangerouslySetInnerHTML:{__html:n.replace(c,'\n              <span style="color:#1890ff;">\n                '.concat(c,"\n              </span>\n            "))}}),y.a.createElement("span",{className:Te.a.account,dangerouslySetInnerHTML:{__html:a.replace(c,'\n              <span style="color:#1890ff;">\n                '.concat(c,"\n              </span>\n            "))}}),r&&y.a.createElement("span",{className:Te.a.authTag},"\u5df2\u6dfb\u52a0"))});return y.a.createElement($["a"],{className:Te.a.authDialog,width:"680px",onCancel:this.handleCloseModal,footer:null,title:"\u4ea7\u54c1\u6388\u6743",visible:t,maskClosable:!1},y.a.createElement(ke["a"],{className:Te.a.inputRow},y.a.createElement(Ce["a"],{className:Te.a.label},"\u6dfb\u52a0\u6210\u5458\uff1a"),y.a.createElement(Ce["a"],{className:Te.a.rowContent},y.a.createElement(we["a"],{dropdownClassName:Te.a.authSearchDropdown,style:{width:"100%"},dataSource:s,value:c,placeholder:"\u8bf7\u8f93\u5165\u57df\u8d26\u53f7\u6216\u59d3\u540d",optionLabelProp:"value",filterOption:!1,onSelect:this.handleSelectUser,onSearch:this.handleInputSearch}))),y.a.createElement(ke["a"],null,y.a.createElement(Ce["a"],{className:Te.a.label},"\u5df2\u6dfb\u52a0\u6210\u5458\uff1a"),y.a.createElement(Ce["a"],{className:Te.a.rowContent},y.a.createElement(I["a"],{className:Te.a.productUsers,rowKey:"id",pagination:!1,size:"small",columns:i,locale:{emptyText:"\u5c1a\u672a\u6dfb\u52a0\u6210\u5458"},scroll:{y:250},dataSource:l,loading:n}))))}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t=e.authUserList,n=e.productId,r=a.productUsers,o=oe()(t,n,[]);return Ne()(r,o)?null:{productUsers:o}}}]),a}(v["PureComponent"]),G.defaultProps={show:!1},z=M))||z),Pe=xe,De=t("SXhs"),Ue=t.n(De),Re=(Q=Object(E["connect"])(function(e){var a=e.tracker,t=e.loading;return{trackerUpdateInfo:a.updateInfo,infoLoading:oe()(t,["effects","product/fetchTrackerUpdateInfo"],!1)}}),Q((Z=J=function(e){function a(){var e,t;s()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=m()(this,(e=f()(a)).call.apply(e,[this].concat(r))),t.state={confirmLoading:!1,trackerInfo:[]},t.handleSubmitUpgrade=function(){var e=t.props,a=e.dispatch,n=e.onCancel,r=e.application,o=e.product,l=e.trackerLatestVersion,c={type:"product/fetchUpgradeProductTracker",payload:{product_id:o.id}};r&&r.id&&(c.type="product/fetchOperationAppTracker",c.payload={product_id:o.id,app_id:r.id,operation:"\u5347\u7ea7",version:l}),t.setState({confirmLoading:!0}),a(c).then(function(e){t.setState({confirmLoading:!1}),e.result&&n()})},t}return g()(a,e),d()(a,[{key:"getSnapshotBeforeUpdate",value:function(e){var a=this.props,t=a.application,n=a.product,r=a.show,o=e.application,l=e.product,c=oe()(t||n,"id",""),i=oe()(o||l,"id","");return!(!r||!c||c===i)}},{key:"componentDidUpdate",value:function(e,a,t){t&&this._getUpdateInfo()}},{key:"render",value:function(){var e=this.props,a=e.show,t=e.onCancel,n=e.product,r=e.application,o=e.trackerLatestVersion,l=this.state,c=l.confirmLoading,i=l.trackerInfo,s=oe()(n,"name","-"),p=!r,d=p?"\u5168\u90e8\u5e94\u7528":oe()(r,"name","-"),u=oe()(r,"tracker_version_number","-")||"-";return y.a.createElement($["a"],{className:Ue.a.trackerUpgrade,width:"680px",onCancel:t,onOk:this.handleSubmitUpgrade,title:"\u5347\u7ea7\u63a2\u9488\u7248\u672c",visible:a,maskClosable:!1,confirmLoading:c,okText:"\u5347\u7ea7",cancelText:"\u53d6\u6d88"},y.a.createElement("div",{className:Ue.a.titleWrap},y.a.createElement("div",{className:Ue.a.title},s,y.a.createElement("span",{className:Ue.a.lightText},"-"),d,p?y.a.createElement("span",{className:Ue.a.lightText},"\u7684\u63a2\u9488\u7248\u672c\u5c06\u5347\u7ea7\u5230"):y.a.createElement(v["Fragment"],null,y.a.createElement("span",{className:Ue.a.lightText},"\u7684\u63a2\u9488\u7248\u672c\u5c06\u4ece"),u,y.a.createElement("span",{className:Ue.a.lightText},"\u5347\u7ea7\u5230")),o)),y.a.createElement("div",{className:Ue.a.updateLog},i.map(function(e){var a=e.update_log,t=e.version_number,n=a.split("\n");return y.a.createElement(v["Fragment"],null,y.a.createElement("div",{className:Ue.a.versionTitle},t,y.a.createElement("span",{className:Ue.a.lightText},"\u66f4\u65b0\u5185\u5bb9")),y.a.createElement("ul",{style:{paddingBottom:"16px"}},n.map(function(e,a){return y.a.createElement("li",{key:"".concat(t,"-log-").concat(a),className:Ue.a.logItem},e)})))})))}},{key:"_getUpdateInfo",value:function(){var e=this.props,a=e.dispatch,t=e.application,n=e.product,r={id:n.id,type:"product"};t&&(r.id=t.id,r.type="app"),a({type:"tracker/fetchTrackerUpdateInfo",payload:r})}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t=e.trackerUpdateInfo,n=e.application,r=e.product,o=a.trackerInfo,l=n||r||{},c=oe()(t,l.id,[]);return Ne()(o,c)?null:{trackerInfo:c}}}]),a}(v["PureComponent"]),J.defaultProps={show:!1},X=Z))||X),Oe=Re,Ve=(t("T2oS"),t("W9HT")),Fe=(t("RC8p"),t("rgW5")),Be=t("Odr2"),Ke=t.n(Be),We=function(e){function a(){var e,t;s()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=m()(this,(e=f()(a)).call.apply(e,[this].concat(r))),t.state={loading:!0,rollbackVersion:"",logs:[]},t.handleRollback=function(){var e=t.props,a=e.applicationId,n=e.productId;t.setState({loading:!0}),window.g_app._store.dispatch({type:"product/fetchOperationAppTracker",payload:{version:t.state.rollbackVersion,operation:"\u56de\u6eda",product_id:n,app_id:a}}).then(function(e){var a={loading:!1};e.result?t._getData():t.setState({loading:!1}),t.setState(function(){return a})})},t}return g()(a,e),d()(a,[{key:"getSnapshotBeforeUpdate",value:function(e){var a=this.props,t=a.applicationId,n=a.show;return!(!n||!t||t===e.applicationId)}},{key:"componentDidUpdate",value:function(e,a,t){t&&this._getData()}},{key:"render",value:function(){var e=this.props,a=e.show,t=e.onCancel,n=this.state,r=n.loading,o=n.logs,l=n.rollbackVersion,c=Array.isArray(o)&&o.length>0;return y.a.createElement($["a"],{className:Ke.a.upgradeLog,onCancel:t,width:"680px",title:"\u63a2\u9488\u4fee\u6539\u5386\u53f2",footer:null,visible:a,maskClosable:!1},y.a.createElement(Ve["a"],{spinning:r},l&&y.a.createElement(de["a"],{title:y.a.createElement("div",null,y.a.createElement("p",{style:{marginBottom:"4px"}},"\u786e\u5b9a\u5c06\u5e94\u7528\u96c6\u6210\u7684\u63a2\u9488\u7248\u672c\u56de\u6eda\u5230",l,"\uff1f"),y.a.createElement("p",{style:{marginBottom:"0"}},"\u786e\u5b9a\u56de\u6eda\u540e\u7acb\u5373\u751f\u6548")),onConfirm:this.handleRollback,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},y.a.createElement("div",{className:Ke.a.rollbackWrap},y.a.createElement("div",{className:Ke.a.rollback},y.a.createElement(k["a"],{type:"upgrade",className:Ke.a.upgradeIcon}),"\u56de\u6eda\u5230",l))),y.a.createElement(Fe["a"],{className:Ke.a.logList},c&&o.map(function(e){var a=e.name,t=e.created_on,n=e.operation,r=e.prev_version_number,o=e.version_number,l=t.slice(0,-3).split("T");return y.a.createElement(Fe["a"].Item,{className:Ke.a.logItem},y.a.createElement("div",{className:Ke.a.tip},a||"\u672a\u77e5\u7528\u6237",y.a.createElement("span",null,"\u5c06"),r||"-",y.a.createElement("span",null,n,"\u5230"),o),y.a.createElement("div",{className:Ke.a.time},l[0],"\u2002",l[1]))}))))}},{key:"_getData",value:function(){var e=this,a=this.props.applicationId;a&&(this.setState({loading:!0}),window.g_app._store.dispatch({type:"product/fetchAppTrackerRollbackVersion",payload:a}).then(function(t){t.result&&e.setState({rollbackVersion:t.data},function(){window.g_app._store.dispatch({type:"product/fetchAppTrackerUpgradeLogs",payload:a}).then(function(a){var n={loading:!1};t.result&&(n.logs=a.data),e.setState(function(){return n})})})}))}}]),a}(v["PureComponent"]);We.defaultProps={show:!1};var Ye=We;function qe(e,a){if(!a)return!0;var t=e.split("."),n=a.split(".");if(3!==n.length)return!0;for(var r=0;r<3;r++)if(t[r]>n[r])return!0;return!1}var je,ze,Ge,Me=t("7nsL"),Qe=t.n(Me),Xe=(je=Object(E["connect"])(function(e){var a=e.product,t=e.tracker;return{productList:a.productList,trackerLatestVersion:t.latestVersion}}),je((Ge=function(e){function a(){var e,t;s()(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t=m()(this,(e=f()(a)).call.apply(e,[this].concat(r))),t.state={loading:!0,pList:[],dialogShow:!1,product:void 0,application:void 0},t.renderProductDialog=function(){var e=t.state,a=e.dialogShow,n=e.product;return y.a.createElement(se,{show:"product"===a,product:n,onCancel:t.handleCloseDialog})},t.renderApplicationDialog=function(){var e=t.state,a=e.dialogShow,n=e.product,r=e.application;return y.a.createElement(Ee,{show:"app"===a,productId:oe()(n,"id",""),applicationId:oe()(r,"id",""),onCancel:t.handleCloseDialog})},t.renderAuthDialog=function(){var e=t.state,a=e.dialogShow,n=e.product;return y.a.createElement(Pe,{show:"auth"===a,productId:oe()(n,"id",""),onCancel:t.handleCloseDialog})},t.renderTrackerUpgradeDialog=function(){var e=t.props.trackerLatestVersion,a=t.state,n=a.dialogShow,r=a.product,o=a.application;return y.a.createElement(Oe,{show:"tracker"===n,product:r,application:o,trackerLatestVersion:e,onCancel:t.handleCloseDialog})},t.renderUpgradeLogDialog=function(){var e=t.state,a=e.dialogShow,n=e.application,r=e.product;return y.a.createElement(Ye,{show:"history"===a,productId:oe()(r,"id",""),applicationId:oe()(n,"id",""),onCancel:t.handleCloseDialog})},t.handleOpenDialog=function(e,a,n){t.setState({dialogShow:e,product:a,application:n})},t.handleCloseDialog=function(){t.setState({dialogShow:!1},function(){t.setState({product:void 0,application:void 0})})},t}return g()(a,e),d()(a,[{key:"componentDidMount",value:function(){this._getData()}},{key:"render",value:function(){var e=this,a=this.state,t=a.pList,r=a.loading;return!r&&y.a.createElement("div",{className:Qe.a.product},y.a.createElement("div",{className:Qe.a.wrap},Array.isArray(t)&&t.length>0?y.a.createElement(v["Fragment"],null,y.a.createElement("div",{className:Qe.a.addBtn1,onClick:function(){return e.handleOpenDialog("product")}},y.a.createElement(k["a"],{type:"add",className:Qe.a.addIcon}),"\u6dfb\u52a0\u4ea7\u54c1"),y.a.createElement("div",{className:Qe.a.list},t.map(function(a){var t=a.has_permission,n=a.need_update,r=c()(a,["has_permission","need_update"]);return y.a.createElement(H,o()({key:r.id,needUpdateTracker:n,editAuth:!!t,onOpenEdit:function(t,n){return e.handleOpenDialog(t,a,n)}},r))}))):y.a.createElement("div",{className:Qe.a.empty},y.a.createElement(n["a"],{type:"primary",size:"large",icon:"plus",block:!0,onClick:function(){return e.handleOpenDialog("product")}},"\u6dfb\u52a0\u4ea7\u54c1"))),this.renderProductDialog(),this.renderApplicationDialog(),this.renderAuthDialog(),this.renderTrackerUpgradeDialog(),this.renderUpgradeLogDialog())}},{key:"_getData",value:function(){var e=this,a=this.props.dispatch;a({type:"tracker/fetchTrackerLatestVersion"}),a({type:"product/fetchProductList"}).then(function(){e.setState({loading:!1})})}}],[{key:"getDerivedStateFromProps",value:function(e,a){var t=e.productList,n=e.trackerLatestVersion,r=a.pList;if(n&&Array.isArray(t)){var o=t.map(function(e){if(Array.isArray(e.apps)&&e.apps.length>0){var a=!0;e.apps=e.apps.map(function(e){return e.is_online&&qe(n,e.tracker_version_number)?(e.need_update=!0,a=!1):e.need_update=!1,e}),e.need_update=!a}return e});if(!Ne()(o,r))return{pList:o}}return null}}]),a}(v["PureComponent"]),ze=Ge))||ze);a["default"]=Xe}}]);