(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{CH51:function(e,t,a){"use strict";var l=a("TqRt"),r=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=l(a("kLXV")),u=l(a("MVZn")),i=l(a("lwsE")),o=l(a("W8MJ")),d=l(a("a1gu")),c=l(a("Nsbk")),s=l(a("7W2i"));a("y8nQ");var f=l(a("Vl3Y"));a("5NDa");var p,m,h,v,k=l(a("5rEg")),_=r(a("q1tI")),g=(l(a("17x9")),l(a("mwIZ"))),y=l(a("wE01")),b=k.default.TextArea,w=(p=f.default.create(),p((v=h=function(e){function t(){var e,a;(0,i.default)(this,t);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return a=(0,d.default)(this,(e=(0,c.default)(t)).call.apply(e,[this].concat(r))),a.state={confirmLoading:!1},a.handleSubmitTracker=function(e){e.preventDefault();var t=a.props,l=t.form,r=t.onCancel,n=t.tracker,i=l.validateFields,o=l.resetFields;i(function(e,t){if(!e){a.setState({confirmLoading:!0});var l=(0,u.default)({},t);n&&(l.id=n.id),window.g_app._store.dispatch({type:n?"tracker/fetchUpdateTracker":"tracker/fetchAddTracker",payload:l}).then(function(e){a.setState({confirmLoading:!1}),e.result&&(o(),r())})}})},a.handleCancel=function(){if(!a.state.confirmLoading){var e=a.props,t=e.form,l=e.onCancel,r=t.resetFields;r(),l()}},a.validateTrackerVersion=function(e,t,a){t&&!/^\d+\.\d+\.\d+$/.test(t)?a("\u683c\u5f0f\u4e3a\u5fc5\u987b\u4e3ax.x.x!"):a()},a}return(0,s.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e=this.props,t=e.show,a=e.form,l=e.tracker,r=this.state.confirmLoading,u=a.getFieldDecorator;return _.default.createElement(n.default,{width:"680px",onCancel:this.handleCancel,onOk:this.handleSubmitTracker,title:l?"\u4fee\u6539\u63a2\u9488\u7248\u672c":"\u6dfb\u52a0\u63a2\u9488\u7248\u672c",visible:t,maskClosable:!1,confirmLoading:r,okText:l?"\u4fee\u6539":"\u6dfb\u52a0",cancelText:"\u53d6\u6d88"},_.default.createElement(f.default,{onSubmit:this.handleSubmitTracker,className:y.default.form},_.default.createElement(f.default.Item,{required:!1,label:"\u7248\u672c\u53f7",labelCol:{span:3},wrapperCol:{span:21}},u("version_number",{initialValue:(0,g.default)(l,"version_number",""),rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ea7\u54c1\u7f16\u7801!"},{validator:this.validateTrackerVersion}]})(_.default.createElement(k.default,{disabled:!!l,placeholder:"\u8bf7\u8f93\u5165\u7248\u672c\u53f7",autoComplete:"off"}))),_.default.createElement(f.default.Item,{required:!1,label:"\u66f4\u65b0\u5185\u5bb9",labelCol:{span:3},wrapperCol:{span:21}},u("update_log",{initialValue:(0,g.default)(l,"update_log",""),rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u66f4\u65b0\u5185\u5bb9!"},{validator:this.validateProductCode}]})(_.default.createElement(b,{autosize:{minRows:6,maxRows:10},placeholder:"\u8bf7\u8f93\u5165\u66f4\u65b0\u5185\u5bb9",autoComplete:"off"})))))}}]),t}(_.PureComponent),h.defaultProps={show:!1},m=v))||m),C=w;t.default=C},IDvR:function(e,t,a){e.exports={tracker:"tracker___1bDaw",title:"title___36v7v",addBtn:"addBtn___1pa0Y",listWrap:"listWrap___2kNJz",list:"list___uokY7",trackerItem:"trackerItem____i1Zg",ver:"ver___sld6C",date:"date___3x7hQ",pubBtn:"pubBtn___3TpSn",updateLog:"updateLog___16O5T",logItem:"logItem___3o0uW",action:"action___3QY7L",btn:"btn___3Nojo",btnIcon:"btnIcon___2Orf-"}},ib03:function(e,t,a){"use strict";var l=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a("q1tI"));a("Pwec");var n=l(a("CtXQ")),u=function(){return r.default.createElement("div",{style:{width:"100%",textAlign:"center",paddingTop:"8%"}},r.default.createElement(n.default,{type:"minus-circle",style:{fontSize:"100px"}}),r.default.createElement("p",{style:{fontSize:"50px",paddingTop:"3%"}},"\u6ca1\u6709\u8bbf\u95ee\u6743\u9650"))},i=u;t.default=i},kUKK:function(e,t,a){"use strict";var l=a("284h"),r=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("2qtc");var n=r(a("kLXV"));a("14J3");var u=r(a("BMrR"));a("5NDa");var i=r(a("5rEg"));a("jCWc");var o=r(a("kPKH"));a("+L6B");var d=r(a("2/Rp"));a("miYZ");var c=r(a("tsqr")),s=r(a("lwsE")),f=r(a("W8MJ")),p=r(a("a1gu")),m=r(a("Nsbk")),h=r(a("7W2i")),v=l(a("q1tI")),k=(r(a("17x9")),r(a("wFMg"))),_=function(e){function t(){var e,a;(0,s.default)(this,t);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return a=(0,p.default)(this,(e=(0,m.default)(t)).call.apply(e,[this].concat(r))),a.state={loading:!0,url:""},a.handleCopyUrl=function(){a.inputRef.select(),document.execCommand("Copy"),c.default.success("\u63a2\u9488\u8def\u5f84\u590d\u5236\u6210\u529f")},a}return(0,h.default)(t,e),(0,f.default)(t,[{key:"getSnapshotBeforeUpdate",value:function(e){var t=this.props,a=t.version,l=t.show;return!(!l||!a||a===e.version)}},{key:"componentDidUpdate",value:function(e,t,a){a&&this._getTrackerUrl()}},{key:"render",value:function(){var e=this,t=this.props,a=t.show,l=t.onCancel,r=this.state,c=r.loading,s=r.url,f=v.default.createElement(d.default,{type:"primary",className:k.default.copyBtn,loading:c,onClick:this.handleCopyUrl},c?"":"\u590d\u5236");return v.default.createElement(n.default,{width:"680px",onCancel:l,title:"\u63a2\u9488\u8def\u5f84",visible:a,maskClosable:!1,footer:null,className:k.default.urlDialog},v.default.createElement(u.default,{className:k.default.row},v.default.createElement(o.default,{span:3,className:k.default.label},"\u63a2\u9488\u8def\u5f84\uff1a"),v.default.createElement(o.default,{span:21},v.default.createElement(i.default,{ref:function(t){e.inputRef=t},value:s,addonAfter:f,readOnly:!0}))))}},{key:"_getTrackerUrl",value:function(){var e=this;window.g_app._store.dispatch({type:"tracker/fetchTrackerUrl",payload:this.props.version}).then(function(t){var a={loading:!1};t.result&&(a.url=t.data.url),e.setState(function(){return a})})}}]),t}(v.PureComponent);_.defaultProps={show:!1};var g=_;t.default=g},vsho:function(e,t,a){"use strict";var l=a("TqRt"),r=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(a("o0o1")),u=l(a("yXPU"));a("RC8p");var i=l(a("rgW5"));a("+L6B");var o,d,c,s=l(a("2/Rp")),f=l(a("lwsE")),p=l(a("W8MJ")),m=l(a("a1gu")),h=l(a("Nsbk")),v=l(a("7W2i")),k=r(a("q1tI")),_=a("MuoO"),g=l(a("WvCx")),y=l(a("ib03")),b=l(a("CH51")),w=l(a("kUKK")),C=l(a("uFPn")),E=l(a("IDvR")),T=(o=(0,_.connect)(function(e){var t=e.user,a=e.tracker;return{userProfile:t.profile,trackerList:a.list}}),o((c=function(e){function t(){var e,a;(0,f.default)(this,t);for(var l=arguments.length,r=new Array(l),n=0;n<l;n++)r[n]=arguments[n];return a=(0,m.default)(this,(e=(0,h.default)(t)).call.apply(e,[this].concat(r))),a.state={loading:!0,dialogShow:!1,tracker:null},a.handleDeleteTracker=function(e,t){(0,C.default)({title:"\u786e\u8ba4\u5220\u9664\u7248\u672c".concat(e,"\uff1f"),content:"\u6b64\u9879\u64cd\u4f5c\u4e0d\u53ef\u9006\uff0c\u8bf7\u786e\u5b9a\u5df2\u77e5\u6653",onOk:function(){return a.props.dispatch({type:"tracker/fetchDeleteTracker",payload:t})},onCancel:function(){}})},a.handlePublishTracker=function(e,t){(0,C.default)({title:"\u786e\u8ba4\u53d1\u5e03\u7248\u672c".concat(e,"\uff1f"),content:"\u63a2\u9488\u7248\u672c\u4e00\u7ecf\u53d1\u5e03\u4e0d\u53ef\u4fee\u6539\uff0c\u8bf7\u786e\u8ba4",onOk:function(){return a.props.dispatch({type:"tracker/fetchPublishTracker",payload:t})},onCancel:function(){}})},a.handleOpenDialog=function(e,t){a.setState({dialogShow:e,tracker:t})},a.handleCloseDialog=function(){a.setState({dialogShow:!1,tracker:null})},a}return(0,v.default)(t,e),(0,p.default)(t,[{key:"componentDidMount",value:function(){this.props.userProfile.is_super&&this._getTrackerListData()}},{key:"render",value:function(){var e=this,t=this.props,a=t.trackerList,l=t.userProfile,r=this.state.loading;return l.is_super?!r&&k.default.createElement("div",{className:E.default.tracker},k.default.createElement("div",{className:E.default.title},k.default.createElement(s.default,{type:"primary",className:E.default.addBtn,onClick:this.handleOpenDialog.bind(this,"tracker",null)},"\u6dfb\u52a0\u63a2\u9488\u7248\u672c")),k.default.createElement("div",{className:E.default.listWrap},k.default.createElement(i.default,{className:E.default.list},a.map(function(t){return e.renderTrackerItem(t)}))),this.renderTrackerDialog(),this.renderTrackerUrlDialog()):k.default.createElement(y.default,null)}},{key:"renderTrackerItem",value:function(e){var t=e.update_log,a=e.status,l=e.id,r=e.version_number,n=e.modified_on,u=t.split("\n"),o="\u5df2\u53d1\u5e03"===a;return k.default.createElement(i.default.Item,{className:E.default.trackerItem,key:l},k.default.createElement("div",{className:E.default.ver},r,o&&k.default.createElement("p",{className:E.default.date},n.replace(/^([\d-]+)T[\d:]+$/,"$1"))),!o&&k.default.createElement(s.default,{type:"primary",className:E.default.pubBtn,onClick:this.handlePublishTracker.bind(this,r,l)},"\u53d1\u5e03"),k.default.createElement("ul",{className:E.default.updateLog},u.map(function(e,t){return k.default.createElement("li",{className:E.default.logItem,key:"".concat(l,"-log-item-").concat(t)},e)})),k.default.createElement("div",{className:E.default.action},!o&&k.default.createElement("div",{className:E.default.btn,onClick:this.handleOpenDialog.bind(this,"tracker",e)},k.default.createElement(g.default,{type:"edit",className:E.default.btnIcon}),"\u4fee\u6539"),k.default.createElement("div",{className:E.default.btn,onClick:this.handleOpenDialog.bind(this,"url",e)},k.default.createElement(g.default,{type:"path",className:E.default.btnIcon}),"\u63a2\u9488\u8def\u5f84"),!o&&k.default.createElement("div",{className:E.default.btn,onClick:this.handleDeleteTracker.bind(this,r,l)},k.default.createElement(g.default,{type:"delete",className:E.default.btnIcon}),"\u5220\u9664")))}},{key:"renderTrackerDialog",value:function(){var e=this.state,t=e.dialogShow,a=e.tracker;return k.default.createElement(b.default,{show:"tracker"===t,tracker:a,onCancel:this.handleCloseDialog})}},{key:"renderTrackerUrlDialog",value:function(){var e=this.state,t=e.dialogShow,a=e.tracker;return k.default.createElement(w.default,{show:"url"===t,version:a&&a.version_number,onCancel:this.handleCloseDialog})}},{key:"_getTrackerListData",value:function(){var e=(0,u.default)(n.default.mark(function e(){var t,a,l=arguments;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:1,a=this.props.dispatch,e.next=4,a({type:"tracker/fetchTrackerList",payload:{page:t}});case 4:this.setState({loading:!1});case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}]),t}(k.PureComponent),d=c))||d),N=T;t.default=N},wE01:function(e,t,a){e.exports={form:"form___36IWS"}},wFMg:function(e,t,a){e.exports={urlDialog:"urlDialog___3qLgI",row:"row___WCPlZ",label:"label___2t28t",copyBtn:"copyBtn___1lzFJ"}}}]);