(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[31],{"14J3":function(e,t,n){"use strict";n("cIOH"),n("FIfw")},BMrR:function(e,t,n){"use strict";var r=n("qrJ5");t["a"]=r["a"]},"Ehk+":function(e,t,n){},IDvR:function(e,t,n){e.exports={tracker:"tracker___1bDaw",title:"title___36v7v",addBtn:"addBtn___1pa0Y",listWrap:"listWrap___2kNJz",list:"list___uokY7",trackerItem:"trackerItem____i1Zg",ver:"ver___sld6C",date:"date___3x7hQ",pubBtn:"pubBtn___3TpSn",pubText:"pubText___Y7I2I",updateLog:"updateLog___16O5T",logItem:"logItem___3o0uW",action:"action___3QY7L",btn:"btn___3Nojo",btnIcon:"btnIcon___2Orf-"}},RC8p:function(e,t,n){"use strict";n("cIOH"),n("Ehk+")},WvCx:function(e,t,n){"use strict";var r=n("jehZ"),a=n.n(r),o=n("Y/ft"),i=n.n(o),c=n("q1tI"),l=n.n(c),s=n("TSYQ"),u=n.n(s),p=function(e){var t=e.className,n=e.type,r=i()(e,["className","type"]),o=u()(t,"fasticon","fasticon-".concat(n));return l.a.createElement("i",a()({className:o},r))};t["a"]=p},jCWc:function(e,t,n){"use strict";n("cIOH"),n("FIfw")},kPKH:function(e,t,n){"use strict";var r=n("/kpp");t["a"]=r["a"]},m1cH:function(e,t,n){"use strict";t.__esModule=!0;var r=n("rfXi"),a=o(r);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,a.default)(e)}},rfXi:function(e,t,n){e.exports={default:n("0tVQ"),__esModule:!0}},rgW5:function(e,t,n){"use strict";var r=n("q1tI"),a=n("TSYQ"),o=n.n(a),i=n("wEI+");function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&(n[r[a]]=e[r[a]])}return n},u=function(e){return r["createElement"](i["a"],null,function(t){var n,a,i=t.getPrefixCls,u=e.prefixCls,p=e.className,f=e.color,d=void 0===f?"":f,m=e.children,h=e.pending,v=e.dot,y=s(e,["prefixCls","className","color","children","pending","dot"]),g=i("timeline",u),b=o()((n={},l(n,"".concat(g,"-item"),!0),l(n,"".concat(g,"-item-pending"),h),n),p),k=o()((a={},l(a,"".concat(g,"-item-head"),!0),l(a,"".concat(g,"-item-head-custom"),v),l(a,"".concat(g,"-item-head-").concat(d),!0),a));return r["createElement"]("li",c({},y,{className:b}),r["createElement"]("div",{className:"".concat(g,"-item-tail")}),r["createElement"]("div",{className:k,style:{borderColor:/blue|red|green/.test(d)?void 0:d}},v),r["createElement"]("div",{className:"".concat(g,"-item-content")},m))})};u.defaultProps={color:"blue",pending:!1};var p=u,f=n("CtXQ");function d(e){return d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},m.apply(this,arguments)}function h(e){return g(e)||y(e)||v()}function v(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function y(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function g(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),e}function C(e,t){return!t||"object"!==d(t)&&"function"!==typeof t?E(e):t}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}function T(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}function N(e,t){return N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},N(e,t)}var x=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&(n[r[a]]=e[r[a]])}return n},P=function(e){function t(){var e;return k(this,t),e=C(this,O(t).apply(this,arguments)),e.renderTimeline=function(t){var n,a=t.getPrefixCls,i=e.props,c=i.prefixCls,l=i.pending,s=void 0===l?null:l,u=i.pendingDot,d=i.children,v=i.className,y=i.reverse,g=i.mode,k=x(i,["prefixCls","pending","pendingDot","children","className","reverse","mode"]),_=a("timeline",c),w="boolean"===typeof s?null:s,C=o()(_,(n={},b(n,"".concat(_,"-pending"),!!s),b(n,"".concat(_,"-reverse"),!!y),b(n,"".concat(_,"-").concat(g),!!g),n),v),E=s?r["createElement"](p,{pending:!!s,dot:u||r["createElement"](f["a"],{type:"loading"})},w):null,O=y?[E].concat(h(r["Children"].toArray(d).reverse())):[].concat(h(r["Children"].toArray(d)),[E]),T=O.filter(function(e){return!!e}),N=r["Children"].count(T),P="".concat(_,"-item-last"),I=r["Children"].map(T,function(e,t){return r["cloneElement"](e,{className:o()([e.props.className,!y&&s?t===N-2?P:"":t===N-1?P:"","alternate"===g?"".concat(_,t%2===0?"-item-left":"-item-right"):"right"===g?"".concat(_,"-item-right"):""])})});return r["createElement"]("ul",m({},k,{className:C}),I)},e}return T(t,e),w(t,[{key:"render",value:function(){return r["createElement"](i["a"],null,this.renderTimeline)}}]),t}(r["Component"]);P.Item=p,P.defaultProps={reverse:!1,mode:""};t["a"]=P},uFPn:function(e,t,n){"use strict";n("2qtc");var r=n("kLXV");function a(e){var t=e.title,n=void 0===t?"\u786e\u8ba4":t,a=e.content,o=void 0===a?"":a,i=e.okText,c=void 0===i?"\u786e\u8ba4":i,l=e.cancelText,s=void 0===l?"\u53d6\u6d88":l,u=e.onOk,p=void 0===u?function(){}:u,f=e.onCancel,d=void 0===f?function(){}:f;r["a"].confirm({title:n,content:o,okText:c,cancelText:s,onOk:p,onCancel:d})}t["a"]=a},vsho:function(e,t,n){"use strict";n.r(t);var r,a,o,i,c=n("d6i3"),l=n.n(c),s=n("1l/V"),u=n.n(s),p=(n("RC8p"),n("rgW5")),f=(n("+L6B"),n("2/Rp")),d=n("2Taf"),m=n.n(d),h=n("vZ4D"),v=n.n(h),y=n("l4Ni"),g=n.n(y),b=n("ujKo"),k=n.n(b),_=n("MhPg"),w=n.n(_),C=n("q1tI"),E=n.n(C),O=n("MuoO"),T=n("WvCx"),N=(n("2qtc"),n("kLXV")),x=n("p0pE"),P=n.n(x),I=(n("y8nQ"),n("Vl3Y")),S=(n("5NDa"),n("5rEg")),j=(n("17x9"),n("mwIZ")),D=n.n(j),L=n("wE01"),A=n.n(L),B=S["a"].TextArea,q=(r=I["a"].create(),r((i=o=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=g()(this,(e=k()(t)).call.apply(e,[this].concat(a))),n.state={confirmLoading:!1},n.handleSubmitTracker=function(e){e.preventDefault();var t=n.props,r=t.form,a=t.onCancel,o=t.tracker,i=r.validateFields,c=r.resetFields;i(function(e,t){if(!e){n.setState({confirmLoading:!0});var r=P()({},t);o&&(r.id=o.id),window.g_app._store.dispatch({type:o?"tracker/fetchUpdateTracker":"tracker/fetchAddTracker",payload:r}).then(function(e){n.setState({confirmLoading:!1}),e.result&&(c(),a())})}})},n.handleCancel=function(){if(!n.state.confirmLoading){var e=n.props,t=e.form,r=e.onCancel,a=t.resetFields;a(),r()}},n.validateTrackerVersion=function(e,t,n){t&&!/^\d+\.\d+\.\d+$/.test(t)?n("\u683c\u5f0f\u4e3a\u5fc5\u987b\u4e3ax.x.x!"):n()},n}return w()(t,e),v()(t,[{key:"render",value:function(){var e=this.props,t=e.show,n=e.form,r=e.tracker,a=this.state.confirmLoading,o=n.getFieldDecorator;return E.a.createElement(N["a"],{width:"680px",onCancel:this.handleCancel,onOk:this.handleSubmitTracker,title:r?"\u4fee\u6539\u63a2\u9488\u7248\u672c":"\u6dfb\u52a0\u63a2\u9488\u7248\u672c",visible:t,maskClosable:!1,confirmLoading:a,okText:r?"\u4fee\u6539":"\u6dfb\u52a0",cancelText:"\u53d6\u6d88"},E.a.createElement(I["a"],{onSubmit:this.handleSubmitTracker,className:A.a.form},E.a.createElement(I["a"].Item,{required:!0,label:"\u7248\u672c\u53f7",labelCol:{span:4},wrapperCol:{span:20}},o("version_number",{initialValue:D()(r,"version_number",""),rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ea7\u54c1\u7f16\u7801!"},{validator:this.validateTrackerVersion}]})(E.a.createElement(S["a"],{disabled:!!r,placeholder:"\u8bf7\u8f93\u5165\u7248\u672c\u53f7",autoComplete:"off"}))),E.a.createElement(I["a"].Item,{required:!0,label:"\u66f4\u65b0\u5185\u5bb9",labelCol:{span:4},wrapperCol:{span:20}},o("update_log",{initialValue:D()(r,"update_log",""),rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u66f4\u65b0\u5185\u5bb9!"},{validator:this.validateProductCode}]})(E.a.createElement(B,{autosize:{minRows:6,maxRows:10},placeholder:"\u8bf7\u8f93\u5165\u66f4\u65b0\u5185\u5bb9",autoComplete:"off"})))))}}]),t}(C["PureComponent"]),o.defaultProps={show:!1},a=i))||a),R=q,W=(n("14J3"),n("BMrR")),F=(n("jCWc"),n("kPKH")),M=(n("miYZ"),n("tsqr")),U=n("wFMg"),V=n.n(U),Y=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=g()(this,(e=k()(t)).call.apply(e,[this].concat(a))),n.state={loading:!0,url:""},n.handleCopyUrl=function(){n.inputRef.select(),document.execCommand("Copy"),M["a"].success("\u63a2\u9488\u8def\u5f84\u590d\u5236\u6210\u529f")},n}return w()(t,e),v()(t,[{key:"getSnapshotBeforeUpdate",value:function(e){var t=this.props,n=t.version,r=t.show;return!(!r||!n||n===e.version)}},{key:"componentDidUpdate",value:function(e,t,n){n&&this._getTrackerUrl()}},{key:"render",value:function(){var e=this,t=this.props,n=t.show,r=t.onCancel,a=this.state,o=a.loading,i=a.url,c=E.a.createElement(f["a"],{type:"primary",className:V.a.copyBtn,loading:o,onClick:this.handleCopyUrl},o?"":"\u590d\u5236");return E.a.createElement(N["a"],{width:"680px",onCancel:r,title:"\u63a2\u9488\u8def\u5f84",visible:n,maskClosable:!1,footer:null,className:V.a.urlDialog},E.a.createElement(W["a"],{className:V.a.row},E.a.createElement(F["a"],{span:3,className:V.a.label},"\u63a2\u9488\u8def\u5f84\uff1a"),E.a.createElement(F["a"],{span:21},E.a.createElement(S["a"],{ref:function(t){e.inputRef=t},value:i,addonAfter:c,readOnly:!0}))))}},{key:"_getTrackerUrl",value:function(){var e=this;window.g_app._store.dispatch({type:"tracker/fetchTrackerUrl",payload:this.props.version}).then(function(t){var n={loading:!1};t.result&&(n.url=t.data.url),e.setState(function(){return n})})}}]),t}(C["PureComponent"]);Y.defaultProps={show:!1};var J,Q,H,Z=Y,X=n("uFPn"),z=n("IDvR"),K=n.n(z),$=(J=Object(O["connect"])(function(e){var t=e.user,n=e.tracker;return{userProfile:t.profile,trackerList:n.list}}),J((H=function(e){function t(){var e,n;m()(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=g()(this,(e=k()(t)).call.apply(e,[this].concat(a))),n.state={loading:!0,dialogShow:!1,tracker:null},n.handleDeleteTracker=function(e,t){Object(X["a"])({title:"\u786e\u8ba4\u5220\u9664\u7248\u672c".concat(e,"\uff1f"),content:"\u6b64\u9879\u64cd\u4f5c\u4e0d\u53ef\u9006\uff0c\u8bf7\u786e\u5b9a\u5df2\u77e5\u6653",onOk:function(){return n.props.dispatch({type:"tracker/fetchDeleteTracker",payload:t})},onCancel:function(){}})},n.handlePublishTracker=function(e,t){Object(X["a"])({title:"\u786e\u8ba4\u53d1\u5e03\u7248\u672c".concat(e,"\uff1f"),content:"\u63a2\u9488\u7248\u672c\u4e00\u7ecf\u53d1\u5e03\u4e0d\u53ef\u4fee\u6539\uff0c\u8bf7\u786e\u8ba4",onOk:function(){return n.props.dispatch({type:"tracker/fetchPublishTracker",payload:t})},onCancel:function(){}})},n.handleOpenDialog=function(e,t){n.setState({dialogShow:e,tracker:t})},n.handleCloseDialog=function(){n.setState({dialogShow:!1,tracker:null})},n}return w()(t,e),v()(t,[{key:"componentDidMount",value:function(){this.props.userProfile.is_super&&this._getTrackerListData()}},{key:"render",value:function(){var e=this,t=this.props,n=t.trackerList,r=t.userProfile,a=this.state.loading;return!a&&E.a.createElement("div",{className:K.a.tracker},E.a.createElement("div",{className:K.a.title},r.is_super&&E.a.createElement(f["a"],{type:"primary",className:K.a.addBtn,onClick:this.handleOpenDialog.bind(this,"tracker",null)},"\u6dfb\u52a0\u63a2\u9488\u7248\u672c")),E.a.createElement("div",{className:K.a.listWrap},E.a.createElement(p["a"],{className:K.a.list},n.map(function(t){return e.renderTrackerItem(t)}))),this.renderTrackerDialog(),this.renderTrackerUrlDialog())}},{key:"renderTrackerItem",value:function(e){var t=this.props.userProfile.is_super,n=e.update_log,r=e.status,a=e.id,o=e.version_number,i=e.modified_on,c=n.split("\n"),l="\u5df2\u53d1\u5e03"===r;return E.a.createElement(p["a"].Item,{className:K.a.trackerItem,key:a},E.a.createElement("div",{className:K.a.ver},o,l&&E.a.createElement("p",{className:K.a.date},i.replace(/^([\d-]+)T[\d:]+$/,"$1"))),!l&&(t?E.a.createElement(f["a"],{type:"primary",className:K.a.pubBtn,onClick:this.handlePublishTracker.bind(this,o,a)},"\u53d1\u5e03"):E.a.createElement("div",{className:K.a.pubText},"\u672a\u53d1\u5e03")),E.a.createElement("ul",{className:K.a.updateLog},c.map(function(e,t){return E.a.createElement("li",{className:K.a.logItem,key:"".concat(a,"-log-item-").concat(t)},e)})),E.a.createElement("div",{className:K.a.action},!l&&t&&E.a.createElement("div",{className:K.a.btn,onClick:this.handleOpenDialog.bind(this,"tracker",e)},E.a.createElement(T["a"],{type:"edit",className:K.a.btnIcon}),"\u4fee\u6539"),E.a.createElement("div",{className:K.a.btn,onClick:this.handleOpenDialog.bind(this,"url",e)},E.a.createElement(T["a"],{type:"path",className:K.a.btnIcon}),"\u63a2\u9488\u8def\u5f84"),!l&&t&&E.a.createElement("div",{className:K.a.btn,onClick:this.handleDeleteTracker.bind(this,o,a)},E.a.createElement(T["a"],{type:"delete",className:K.a.btnIcon}),"\u5220\u9664")))}},{key:"renderTrackerDialog",value:function(){var e=this.state,t=e.dialogShow,n=e.tracker;return E.a.createElement(R,{show:"tracker"===t,tracker:n,onCancel:this.handleCloseDialog})}},{key:"renderTrackerUrlDialog",value:function(){var e=this.state,t=e.dialogShow,n=e.tracker;return E.a.createElement(Z,{show:"url"===t,version:n&&n.version_number,onCancel:this.handleCloseDialog})}},{key:"_getTrackerListData",value:function(){var e=u()(l.a.mark(function e(){var t,n,r=arguments;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:1,n=this.props.dispatch,e.next=4,n({type:"tracker/fetchTrackerList",payload:{page:t}});case 4:this.setState({loading:!1});case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}]),t}(C["PureComponent"]),Q=H))||Q);t["default"]=$},wE01:function(e,t,n){e.exports={form:"form___36IWS"}},wFMg:function(e,t,n){e.exports={urlDialog:"urlDialog___3qLgI",row:"row___WCPlZ",label:"label___2t28t",copyBtn:"copyBtn___1lzFJ"}}}]);